{% extends "base.html" %}

{% block title %}Cart - Handcrafted Baskets{% endblock %}

{% block content %}
<h1>Your Cart</h1>
{% if products %}
<div class="cart-items">
    {% for item in products %}
    <div class="cart-item">
        <h3>{{ item.product.name }}</h3>
        <p>Quantity: {{ item.quantity }}</p>
        <p>Price: ₹{{ "%.2f"|format(item.product.price) }}</p>
        <a href="{{ url_for('remove_from_cart', id=item.product.id) }}" class="btn small">Remove</a>
    </div>
    {% endfor %}
</div>
<p class="total">Total: ₹{{ "%.2f"|format(total) }}</p>
<a href="#" id="whatsapp-order" class="btn whatsapp">Order via WhatsApp</a>
{% else %}
<p>Your cart is empty.</p>
{% endif %}
<script>
document.getElementById('whatsapp-order').addEventListener('click', function() {
    var message = 'Hello, I would like to order:\n';
    {% for item in products %}
    message += '{{ item.product.name }} - Quantity: {{ item.quantity }} - Price: ₹{{ "%.2f"|format(item.product.price) }}\n';
    {% endfor %}
    message += 'Total: ₹{{ "%.2f"|format(total) }}';
    var url = 'https://wa.me/{{ whatsapp_number }}?text=' + encodeURIComponent(message);
    window.open(url, '_blank');
});
</script>
{% endblock %}